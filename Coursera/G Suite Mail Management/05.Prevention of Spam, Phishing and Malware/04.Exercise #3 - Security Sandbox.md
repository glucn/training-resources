## Introduction

As an administrator, you can set up Gmail to scan (or run) all email attachments, including those sent from inside your domain and from external domains prior to delivery. Alternatively, you can create specific rules for attachment scanning.

Scanning takes place in a virtual environment called the security sandbox. Attachments identified as threats are by default placed into the recipient's spam folder.

In this exercise you will ensure that scanning of all emails is disabled and then create a sandbox rule to examine mail from a single domain only.

Note: If you enable scanning of all email attachments, this overrides any individual rules that you define.

## Scenario

One of your users devices was recently infected by a virus and your investigations have determined that the virus may have come from a malicious attachment in an email sent from *acme.com*.

You are not sure if the this was the source of the problem and you also do receive legitimate emails from *acme.com* so you do not want to blacklist them. Instead you have decided to create a sandbox rule which will examine all emails sent to your organization by *acme.com*.

## Directions

1\. If you are not already signed in, sign in to your domain as the administrator at [admin.google.com](https://admin.google.com/).

2\. Click the Apps icon, click the G Suite icon and then click the Gmail service.

3\. Scroll down and click Advanced settings.

4\. Scroll down to the 'Spam, phishing, and malware' section.

#### Disable scanning of all attachments

5\. Hover over the 'Security sandbox' row and ensure 'Enable virtual execution of attachments in a sandbox environment for all the users of the Organizational Unit for protection against malware, ransomware, and zero-day threats.' is deselected. If it is selected, deselect it, and click SAVE.

#### Now create a sandbox rule for acme.com

6\. Hover over the 'Security sandbox rules' row and click CONFIGURE.

7\. Enter a short description, for example *Check acme.com*.

8\. In 'Email messages to affect', check *Inbound*.

We can leave *Inbound (receiving)* unchecked as we are only interested in messages from the external domain *acme.com*.

9\. Click the Add link in the 'Expressions' box.

You can now choose between the following types of expressions to look for:

-   Simple content match: Look in the entire message for a string value. This works just any normal web search
-   Advanced content match: Here you choose which parts of the message to examine and how to perform the search.
-   Metadata match: Search on metadata items such as IP address, message size, etc.
-   Predefined content match. Here you can choose to apply a predefined Data Loss Prevention (DLP) rule. For example, you might want to scan messages that contain credit card numbers only.

10\. Change the 'Expression type' from *Simple content match* to *Advanced content match*.

11\. Set 'Location' to *Sender header*.

12\. Set 'Match type' to *Contains text*.

13\. Enter *acme.com* into the 'Content' field and click SAVE.

14\. Click ADD SETTING and click SAVE.

All messages received from acme.com will now be processed by the security sandbox.

## Notes

1\. Security sandbox scans run independently of other compliance and pre-delivery scans. For example, your content compliance scans might look for personal information such as credit card numbers. Or attachment compliance scans might block attachments of a specific type or size. Gmail runs those compliance and pre-delivery scans regardless of any security sandbox scans.

2\. Email attachments that are blocked by compliance rules and pre-delivery scans aren't scanned by the security sandbox.

3\. Malware detected by the security sandbox is put in the spam folder by default. To quarantine malware attachments, you can create a content compliance rule using the spam metadata attribute.

## Help Center resources

-   [Set up rules to detect harmful attachments](https://support.google.com/a/answer/7676854 "Set up rules to detect harmful attachments")
